<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Viewer</title>
    <link rel="icon" type="image/png" href="https://static.thenounproject.com/png/225702-200.png">

    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
        }
        header {
            background-color: #007bff;
            color: white;
            padding: 20px 0;
            text-align: center;
        }
        main {
            display: flex;
            height: calc(100vh - 100px); /* Subtract header and footer heights */
        }
        #left-section, #right-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow: auto;
        }
        #left-section {
            background-color: rgb(0, 0, 0);
            border-right: 1px solid #ddd;
        }
        #right-section {
            background-color: #000000;
        }
        #image-container {
            max-width: 100%;
            max-height: 90%;
            text-align: center;
            position: relative;
        }
        img {
            max-width: 100%;
            max-height: 100%;
            transition: transform 0.3s ease;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin: 5px 0;
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        select, input[type="range"] {
            width: auto;
            padding: 10px;
            border-radius: 5px;
            font-size: 16px;
            background-color: #ffffff;
            border: 1px solid #ccc;
            margin: 10px 0;
            min-width: 200px; /* Ensures the dropdown has a minimum width */
            cursor: pointer;
        }
        select:focus {
            outline: none;
            border-color: #007bff;
        }
        label {
            margin: 10px 0;
        }
        footer {
            height: 50px;
            text-align: center;
            padding: 10px 0;
            background-color: #ddd;
            font-size: 14px;
            color: #555;
        }
        #zoom-slider {
            margin: 10px 0;
        }
        #navigation-buttons {
            display: flex;
            justify-content: center; /* Align buttons in the center */
            gap: 10px; /* Adds space between buttons if needed */
            width: 80%;
            margin-top: 20px;
        }
        #navigation-buttons button {
            width: 28%; /* Make buttons take up 48% of the width */
        }
        #file-name {
            margin: 15px 0;
            font-size: 16px;
            font-weight: bold;
        }
        #buttons-container {
            display: flex;
            justify-content:center;
            margin-top: 20px;
            width: 50%;
            gap: 10px;
        }

        .category-button {
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            cursor: pointer;
            margin: 5px;
            border-radius: 5px;
            transition: background-color 0.3s, color 0.3s;
        }

        /* Default colors */
        .real-button {
            background-color: green;
            color: white;
        }

        .fake-button {
            background-color: red;
            color: white;
        }

        /* Selected button styles */
        .category-button.selected {
            background-color: #333;
            color: #fff;
            font-weight: bold;
        }

        #selection-result {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
        }

        #selected-value {
            color: #333;
        }

        /* Style for the Submit button */
        #submit-container {
            margin-top: 20px;
            text-align: center;
        }

        #submit-button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #submit-button:hover {
            background-color: #45a049;
        }

        /* Style for the table */
        #table-container {
            margin-top: 30px;
            text-align: justify;
            width: 100%;
            color: white;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 8px;
            text-align: left;
            border: 1px solid #ddd;
        }

        th {
            background-color: #000000;
        }
        #slider-container {
            background-color: #333;  /* Dark background for the box */
            padding: 20px;
            border-radius: 10px;
            width:400px;
            color: white;  /* White font color */
            font-family: Arial, sans-serif;
        }

        #range-slider {
            width:90%;
        }

        label, #slider-value {
            font-size: 18px;
        }
        #zoom-slider-container {
            background-color: #333;  /* Dark background for the box */
            padding: 20px;
            border-radius: 10px;
            width: fit-content;
            color: white;  /* White font color */
            font-family: Arial, sans-serif;
        }

        #range-slider {
            width: 90%;
        }

        label, #slider-value {
            font-size: 18px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Real vs Fake</h1>
        <h5>Instructions:</h5>
            <ul style="text-align: left;">
                <li>Enter progress input updates or resumes the last progress. Just remember the last progress percentage, and you can resume from there. You can enter an input value, and it resumes the images from the last point.</li>
                <li>Make sure to validate inputs to avoid unexpected behavior.</li>
                <li>Click the "Resume" button to apply the entered progress percentage.</li>
                <li>Use the "Reset" button to start over from 0% progress.</li>
            </ul>
    </header>

    <main>
        <!-- Left Section: Image Display -->
        <section id="left-section">
            <div id="image-container">
                <img id="image" src="" alt="">
            </div>
        </section>

        <!-- Right Section: Configuration -->
        <section id="right-section">
            <!-- <label for="folder-dropdown">Select Folder:</label> -->
            
            <!-- <select id="folder-dropdown" onchange="loadImages()">
                <option value="">Select a Folder</option>
                {% for folder in folders %}
                    <option value="{{ folder }}">{{ folder }}</option>
                {% endfor %}
            </select> -->
            <div style="margin: 20px 0; text-align: center;">
                <label for="progress-input" style="color: white; font-size: 16px; font-weight: bold; margin-right: 10px;">
                    Enter Progress (%):
                </label>
                <input type="number" id="progress-input" 
                       style="padding: 8px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; width: 80px;" 
                       min="0" max="100" step="0.1" placeholder="0-100">
                <button onclick="jumpToProgress()" 
                        style="padding: 8px 12px; background-color: #007BFF; color: white; border: none; 
                               border-radius: 4px; font-size: 14px; cursor: pointer;">
                    Update Progress
                </button>
            </div>
            <div id="zoom-slider-container">
                <label for="zoom-slider">Zoom: <span id="zoom-percentage">100%</span></label>
                <input id="zoom-slider" type="range" min="100" max="500" step="50" value="100" oninput="adjustZoom()">
            </div>
            <div id="navigation-buttons">
                <button id="next-button" 
                    onmousedown="startSpeedNavigation()" 
                    onmouseup="stopSpeedNavigation()" 
                    onmouseleave="stopSpeedNavigation()">Next</button>
            </div>
            <div id="progress-percentage" style="color: #ccc;">Progress: 0.00000%</div>
            <br>

            
            
            <div id="buttons-container">
                <button id="real-button" class="category-button real-button" onclick="selectReal()">Real</button>
                <button id="fake-button" class="category-button fake-button" onclick="selectFake()">Fake</button>
            </div>
            <p id="selected-value" style="color: white;">Selected: None</p>
            
            <div id="slider-container">
                <label for="range-slider">Confidence Value: <span id="confidence-label">Neutral</span></label>
                <input id="range-slider" type="range" min="1" max="10" value="5" oninput="updateConfidenceLabel()">
            </div>          
            <!-- Display the Selected Value Below -->
            <!-- <div id="selection-result">
                <p id="selected-value">No value selected</p>
            </div> -->
            <!-- Submit button -->
            <div id="submit-container">
                <button id="submit-button" onclick="submitSelection()">Submit</button>
            </div>
            <div id="file-name" style="color: #000000;"></div>

            <!-- Table to Display the Result -->
            <div id="table-container" style="display: none;">
                <table border="1">
                    <thead>
                        <tr>
                            <th>Selected Folder</th>
                            <th>Selected File</th>
                            <th>Zoom Percentage</th>
                            <th>Confidence Value</th>
                            <th>Real vs Fake</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td id="folder-value">N/A</td>
                            <td id="file-value">N/A</td>
                            <td id="zoom-value">N/A</td>
                            <td id="confidence-label-tb">N/A</td>
                            <td id="real-fake-value">N/A</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Image Quiz App. All rights reserved. Code by Sanyam Jain.</p>
    </footer>
    <script>
        let currentIndex = 0; // Track the current image index
        let selectedRealFake = null;
        let zoomPercentage = 100;
        let confidenceValue = 5;
        const images = []; // Array to hold image paths
        function loadImages() {
            const folder = "100px";
            if (!folder) {
                alert("Please select a folder.");
                return;
            }
    
            images.length = 0; // Clear previous images
            fetch(`/get-images?folder=${encodeURIComponent(folder)}`)
                .then(response => response.json())
                .then(data => {
                    if (data.length > 0) {
                        images.push(...data);
                        currentIndex = 0; // Start with the first image
                        displayImage();
                        updateProgress(); // Update progress after images are loaded
                    } else {
                        alert("No images found in the selected folder.");
                        clearImageDisplay();
                        document.getElementById("progress-percentage").innerText = "Progress: 0.00000%";
                    }
                })
                .catch(error => {
                    console.error("Error fetching images:", error);
                });
        }
        window.onload = function() { loadImages(); };
    
        function displayImage() {
            if (currentIndex >= 0 && currentIndex < images.length) {
                const imageElement = document.getElementById('image');
                imageElement.src = images[currentIndex];
                document.getElementById('file-name').textContent = `File: ${images[currentIndex].split('/').pop()}`;
                updateZoom();
            } else {
                clearImageDisplay();
            }
        }
    
        function clearImageDisplay() {
            const imageElement = document.getElementById('image');
            imageElement.src = ''; // Clear the image
            document.getElementById('file-name').textContent = 'No image selected.';
        }
    
        function prevImage() {
            if (currentIndex > 0) {
                currentIndex--;
                displayImage();
                updateProgress();
            } else {
                alert("You are already at the first image.");
            }
        }
    
        function updateProgress() {
            if (images.length > 0) {
                const progress = ((currentIndex + 1) / images.length) * 100;
                document.getElementById("progress-percentage").innerText = `Progress: ${progress.toFixed(3)}%`;
            } else {
                document.getElementById("progress-percentage").innerText = "Progress: 0.00000%";
            }
        }
    
        function jumpToProgress() {
            const inputPercentage = parseFloat(document.getElementById("progress-input").value);
            if (isNaN(inputPercentage) || inputPercentage < 0 || inputPercentage > 100) {
                alert("Please enter a valid percentage (0-100).");
                return;
            }
    
            const targetIndex = Math.floor((inputPercentage / 100) * images.length) - 1;
            if (targetIndex >= 0 && targetIndex < images.length) {
                currentIndex = targetIndex;
                displayImage();
                updateProgress();
            } else {
                alert("Invalid percentage value. No corresponding image.");
            }
        }
    
        let speedNavigationInterval = null;
    
        function startSpeedNavigation() {
            nextImage();
            speedNavigationInterval = setInterval(() => {
                nextImage();
            }, 100);
        }
    
        function stopSpeedNavigation() {
            if (speedNavigationInterval) {
                clearInterval(speedNavigationInterval);
                speedNavigationInterval = null;
            }
        }
    
        function nextImage() {
            if (currentIndex < images.length - 1) {
                currentIndex++;
                displayImage();
                updateProgress();
            } else {
                alert("You are already at the last image.");
                stopSpeedNavigation();
            }
        }
    
        function adjustZoom() {
            zoomPercentage = document.getElementById('zoom-slider').value;
            document.getElementById('zoom-percentage').innerText = `${zoomPercentage}%`;
            updateZoom();
        }
    
        function updateZoom() {
            const imageElement = document.getElementById('image');
            imageElement.style.transform = `scale(${zoomPercentage / 100})`;
        }
    
        function updateConfidenceLabel() {
            const slider = document.getElementById('range-slider');
            const label = document.getElementById('confidence-label');
            const confidenceLabels = [
                'Completely unsure', 'Very unsure', 'Unsure', 'Somewhat unsure', 'Neutral',
                'Somewhat sure', 'Sure', 'Very sure', 'Almost completely sure', 'Completely sure'
            ];
            const value = slider.value;
            label.textContent = confidenceLabels[value - 1];
            confidenceValue = label.textContent;
        }
    
        

        function selectReal() {
            selectedRealFake = 'Real';
            document.getElementById('selected-value').innerText = 'Selected: Real';

            // Apply styles to the buttons
            document.getElementById('real-button').classList.add('selected');
            document.getElementById('fake-button').classList.remove('selected');
        }

        function selectFake() {
            selectedRealFake = 'Fake';
            document.getElementById('selected-value').innerText = 'Selected: Fake';

            // Apply styles to the buttons
            document.getElementById('fake-button').classList.add('selected');
            document.getElementById('real-button').classList.remove('selected');
        }

    
        function submitSelection() {
            if (!selectedRealFake) {
                alert("Please select Real or Fake.");
                return;
            }
    
            const folder = "100px";
            const file = images[currentIndex] ? images[currentIndex].split('/').pop() : "N/A";
    
            document.getElementById('folder-value').innerText = folder;
            document.getElementById('file-value').innerText = file;
            document.getElementById('zoom-value').innerText = `${zoomPercentage}%`;
            document.getElementById('confidence-label-tb').innerText = confidenceValue;
            document.getElementById('real-fake-value').innerText = selectedRealFake;
    
            document.getElementById('table-container').style.display = 'block';
        }
    </script>
    
    
    
    
</body>
</html>
